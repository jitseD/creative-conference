---
import BaseLayout from "../../layouts/BaseLayout.astro";
import SpeakerCard from "../../components/SpeakerCard.astro";
import PrevNext from "../../components/PrevNext.astro";
import fetchApi from "../../lib/strapi";

export async function getStaticPaths() {
    const speakers = await fetchApi({
        endpoint: "speakers",
        wrappedByKey: "data",
        query: { populate: "*" },
    });

    const paths = speakers.map((speaker, i) => ({
        params: { id: speaker.slug.toString() },
        props: {
            speaker,
            next: i < speakers.length - 1 ? speakers[i + 1] : null,
            prev: i > 0 ? speakers[i - 1] : null,
        },
    }));
    return paths;
}

const { speaker, prev, next } = Astro.props;
---

<BaseLayout pageTitle={speaker.attributes.name}>
    <SpeakerCard speaker={speaker} />
    <PrevNext prev={prev} next={next} path="speakers" />
</BaseLayout>
